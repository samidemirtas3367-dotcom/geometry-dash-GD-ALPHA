<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>GD ALPHA</title>
    <style>
        body { margin: 0; background: #000; overflow: hidden; font-family: 'Arial Black', sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; }
        #gameWrapper { position: relative; width: 800px; height: 400px; border: 4px solid #333; }
        canvas { background: linear-gradient(#000428, #001f3f); display: block; }
        
        .overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center; background: rgba(0,0,0,0.85); color: white; z-index: 100; text-align: center; }
        .hidden { display: none !important; }
        
        h1 { font-size: 60px; color: #00fff2; text-shadow: 0 0 20px #00fff2; margin: 0 0 20px 0; }
        .btn { padding: 15px 40px; margin: 10px; font-size: 20px; cursor: pointer; background: #00fff2; border: none; font-weight: bold; border-radius: 8px; width: 250px; transition: 0.2s; }
        .btn:hover { transform: scale(1.05); background: white; }

        #shopGrid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-bottom: 20px; }
        .shop-item { background: #222; padding: 15px; border: 1px solid #444; border-radius: 8px; width: 130px; }
        .preview-canvas { background: #333; margin-bottom: 10px; border: 1px solid #555; }
        
        #stats { position: absolute; top: 15px; left: 15px; color: white; font-size: 22px; z-index: 50; }
    </style>
</head>
<body>

<div id="gameWrapper">
    <div id="stats">üí∞ <span id="coinDisplay">0</span> | üèÜ <span id="scoreDisplay">0</span></div>

    <div id="mainMenu" class="overlay">
        <h1>GD ALPHA</h1>
        <button class="btn" onclick="startGame()">OYUNA BA≈ûLA</button>
        <button class="btn" onclick="openShop()" style="background:#ff00ff">MAƒûAZA (SKIN)</button>
    </div>

    <div id="shopMenu" class="overlay hidden">
        <h2>SKIN MAƒûAZASI</h2>
        <div id="shopGrid"></div>
        <button class="btn" onclick="closeShop()">GERƒ∞</button>
    </div>

    <canvas id="gameCanvas"></canvas>
</div>

<audio id="bgMusic" loop>
    <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-8.mp3" type="audio/mpeg">
</audio>

<script>
    let canvas, ctx, music;
    let coins = parseInt(localStorage.getItem("gd_coins_alpha")) || 0;
    let unlocked = JSON.parse(localStorage.getItem("gd_skins_alpha")) || ["#00fff2-default"];
    let currentSkin = { color: "#00fff2", type: "default" };
    
    let isPlaying = false;
    let score = 0, speed = 6, gravity = 0.8;

    let player = { x: 100, y: 330, w: 35, h: 35, dy: 0, rot: 0, grounded: false };
    let obstacles = [];
    let spawnTimer = 0;

    const shopItems = [
        { name: "Bo≈ü Kare", color: "#00fff2", type: "hollow", price: 0 },
        { name: "G√ºlen", color: "#ffd700", type: "smile", price: 10 },
        { name: "X-G√∂z", color: "#ff2e63", type: "xg√∂z", price: 20 },
        { name: "Robot", color: "#a29bfe", type: "robot", price: 30 }
    ];

    window.onload = function() {
        canvas = document.getElementById("gameCanvas");
        ctx = canvas.getContext("2d");
        music = document.getElementById("bgMusic");
        canvas.width = 800; canvas.height = 400;
        updateUI();
    };

    function updateUI() {
        document.getElementById("coinDisplay").innerText = coins;
        document.getElementById("scoreDisplay").innerText = score;
        localStorage.setItem("gd_coins_alpha", coins);
        localStorage.setItem("gd_skins_alpha", JSON.stringify(unlocked));
    }

    // --- KARAKTER √áƒ∞Zƒ∞M FONKSƒ∞YONU (EMOJƒ∞Sƒ∞Z, GRAFƒ∞KSEL) ---
    function drawPlayerShape(context, x, y, size, color, type) {
        context.fillStyle = color;
        context.fillRect(x, y, size, size);
        context.strokeStyle = "white";
        context.lineWidth = 2;
        context.strokeRect(x, y, size, size);

        // ƒ∞√ßindeki "oyma" efektleri i√ßin siyah renk kullanƒ±yoruz
        context.fillStyle = "black";
        context.strokeStyle = "black";

        if (type === "hollow") {
            // Ortasƒ±nda kare bo≈üluk
            context.fillRect(x + size/4, y + size/4, size/2, size/2);
        } 
        else if (type === "smile") {
            // G√∂zler
            context.fillRect(x + 7, y + 8, 6, 6);
            context.fillRect(x + size - 13, y + 8, 6, 6);
            // Aƒüƒ±z
            context.beginPath();
            context.arc(x + size/2, y + size/2 + 2, 8, 0.2, Math.PI - 0.2);
            context.stroke();
        } 
        else if (type === "xg√∂z") {
            // X ≈üeklinde g√∂zler
            context.lineWidth = 3;
            context.beginPath();
            // Sol X
            context.moveTo(x+6, y+6); context.lineTo(x+14, y+14);
            context.moveTo(x+14, y+6); context.lineTo(x+6, y+14);
            // Saƒü X
            context.moveTo(x+size-14, y+6); context.lineTo(x+size-6, y+14);
            context.moveTo(x+size-6, y+6); context.lineTo(x+size-14, y+14);
            context.stroke();
            // D√ºz aƒüƒ±z
            context.fillRect(x + 10, y + size - 10, size - 20, 3);
        }
        else if (type === "robot") {
            // Viz√∂r
            context.fillRect(x + 4, y + 6, size - 8, 10);
            context.fillStyle = color;
            context.fillRect(x + 8, y + 10, 4, 4); // Parlama
            context.fillStyle = "black";
            // Alt detaylar
            context.fillRect(x + 10, y + 24, 4, 4);
            context.fillRect(x + 20, y + 24, 4, 4);
        }
    }

    function startGame() {
        document.getElementById("mainMenu").classList.add("hidden");
        isPlaying = true; score = 0; speed = 6; obstacles = []; 
        player.y = 330; player.dy = 0;
        music.play().catch(() => {});
        updateUI();
        gameLoop();
    }

    function openShop() {
        document.getElementById("mainMenu").classList.add("hidden");
        document.getElementById("shopMenu").classList.remove("hidden");
        const grid = document.getElementById("shopGrid");
        grid.innerHTML = "";
        
        shopItems.forEach(item => {
            const id = `${item.color}-${item.type}`;
            const isOwned = unlocked.includes(id);
            
            // Maƒüaza i√ßin k√º√ß√ºk √∂nizleme olu≈üturma
            const shopItemDiv = document.createElement('div');
            shopItemDiv.className = 'shop-item';
            
            const previewCanvas = document.createElement('canvas');
            previewCanvas.width = 40;
            previewCanvas.height = 40;
            previewCanvas.className = 'preview-canvas';
            const pCtx = previewCanvas.getContext('2d');
            drawPlayerShape(pCtx, 2.5, 2.5, 35, item.color, item.type);

            shopItemDiv.appendChild(previewCanvas);
            shopItemDiv.innerHTML += `
                <p style="font-size:12px; margin:5px 0;">${item.name}</p>
                <p style="font-size:12px; color: gold;">${isOwned ? 'SAHƒ∞P' : item.price + ' üí∞'}</p>
                <button onclick="buySkin('${item.color}', '${item.type}', ${item.price})" style="width:100%">${isOwned ? 'SE√á' : 'AL'}</button>
            `;
            grid.appendChild(shopItemDiv);
        });
    }

    function buySkin(color, type, price) {
        const id = `${color}-${type}`;
        if(unlocked.includes(id)) { currentSkin = {color, type}; }
        else if(coins >= price) { 
            coins -= price; unlocked.push(id); currentSkin = {color, type}; 
        }
        updateUI(); openShop();
    }

    function closeShop() {
        document.getElementById("shopMenu").classList.add("hidden");
        document.getElementById("mainMenu").classList.remove("hidden");
    }

    function spawn() {
        spawnTimer++;
        if (spawnTimer > 40) {
            let r = Math.random();
            if (r < 0.4) {
                obstacles.push({ x: 800, y: 335, w: 35, h: 35, type: "spike" });
            } else {
                obstacles.push({ x: 800, y: 280, w: 200, h: 20, type: "platform" });
            }
            spawnTimer = 0;
        }
    }

    function gameLoop() {
        if (!isPlaying) return;
        ctx.clearRect(0, 0, 800, 400);

        ctx.fillStyle = "#111"; ctx.fillRect(0, 370, 800, 30);
        player.dy += gravity;
        player.y += player.dy;
        player.grounded = false;

        if (player.y + player.h > 370) {
            player.y = 370 - player.h; player.dy = 0; player.grounded = true;
        }

        spawn();

        obstacles.forEach((obj, i) => {
            obj.x -= speed;
            if (obj.type === "spike") {
                ctx.fillStyle = "#ff2e63";
                ctx.beginPath();
                ctx.moveTo(obj.x, obj.y + 35); ctx.lineTo(obj.x + 17.5, obj.y); ctx.lineTo(obj.x + 35, obj.y + 35);
                ctx.fill();
                if(player.x < obj.x + 25 && player.x + 25 > obj.x && player.y < obj.y + 25 && player.y + 25 > obj.y) gameOver();
            } else {
                ctx.fillStyle = "#00fff2";
                ctx.fillRect(obj.x, obj.y, obj.w, obj.h);
                if (player.x + player.w > obj.x && player.x < obj.x + obj.w) {
                    if (player.y + player.h <= obj.y + 10 && player.y + player.h + player.dy >= obj.y) {
                        player.y = obj.y - player.h; player.dy = 0; player.grounded = true;
                    }
                }
                if (player.x + player.w > obj.x && player.x < obj.x + 10 && player.y + player.h > obj.y + 5) gameOver();
            }
            if (obj.x + obj.w < 0) {
                obstacles.splice(i, 1);
                score++; if(score % 5 === 0) { coins += 2; speed += 0.1; }
                updateUI();
            }
        });

        // Karakter √áizimi
        ctx.save();
        ctx.translate(player.x + 17.5, player.y + 17.5);
        if(!player.grounded) player.rot += 0.15; else player.rot = 0;
        ctx.rotate(player.rot);
        
        // √ñZEL √áƒ∞Zƒ∞M FONKSƒ∞YONU √áAƒûRISI
        drawPlayerShape(ctx, -17.5, -17.5, 35, currentSkin.color, currentSkin.type);
        
        ctx.restore();
        requestAnimationFrame(gameLoop);
    }

    function gameOver() {
        isPlaying = false;
        document.getElementById("mainMenu").classList.remove("hidden");
        document.querySelector("h1").innerText = "PUAN: " + score;
    }

    window.onkeydown = (e) => { if(e.code === "Space" && player.grounded) player.dy = -13; };
    window.onmousedown = () => { if(player.grounded) player.dy = -13; };
</script>
</body>
</html>